generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Queue/job pipeline types
enum JobStatus {
  queued
  running
  done
  error
}

// Keep existing Project as created by 0_init (avoid changing it via Prisma now)
model Project {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  createdAt   DateTime @default(now())
}

// Minimal Job model without FK to Project to avoid cross-version conflicts
model Job {
  id        String    @id @default(cuid())
  projectId String
  kind      String
  payload   Json
  status    JobStatus @default(queued)
  attempts  Int       @default(0)
  error     String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@index([status, createdAt])
}