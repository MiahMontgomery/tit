FROM mcr.microsoft.com/playwright:v1.45.0-jammy
WORKDIR /app

# Copy only package files first
COPY package*.json ./

# Install all dependencies (including dev) but ignore postinstall scripts
RUN npm ci --ignore-scripts

# Copy the rest of the source code

COPY . .
# Build step removed; using tsx runtime

ENV NODE_ENV=production

CMD [["npx","tsx","server/worker.ts"]
