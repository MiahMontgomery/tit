FROM mcr.microsoft.com/playwright:v1.45.0-jammy
WORKDIR /app

# Copy only package files first
COPY package*.json ./

# Install all dependencies (including dev) but ignore postinstall scripts
RUN npm ci --ignore-scripts

# Copy the rest of the source code

COPY . .
# build the worker
RUN npx tsc -p tsconfig.json


ENV NODE_ENV=production

CMD ["node","dist/worker/index.js"]
